var __tea_iife_export__=function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function n(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e}var r=function(e,t){var i,n,r=window.screen.width,o=window.screen.height,s=window.navigator.appVersion,a=window.navigator.userAgent,c=window.navigator.language,u=function(e){var t=function(e){var t=document.createElement("a");return t.href=e,t}(e).search;t=t.slice(1);var i={};return t.split("&").forEach(function(e){var t,n,r=e.split("=");r.length&&(t=r[0],n=r[1]);try{i[t]=decodeURIComponent(void 0===n?"":n)}catch(e){i[t]=n}}),i}(window.location.href),d="",f="",h="",p=""+parseFloat(s);-1!==(i=a.indexOf("Opera"))&&(h="Opera",p=a.substring(i+6),-1!==(i=a.indexOf("Version"))&&(p=a.substring(i+8))),-1!==(i=a.indexOf("Edge"))?(h="Microsoft Edge",p=a.substring(i+5)):-1!==(i=a.indexOf("MSIE"))?(h="Microsoft Internet Explorer",p=a.substring(i+5)):-1!==a.indexOf("Chrome")?-1!==(i=a.indexOf("MicroMessenger"))?(h="weixin",p=a.substring(i+15,i+20)):-1!==(i=a.indexOf("MQQBrowser"))?(h="qqbrowser",p=a.substring(i+11,i+15)):-1!==(i=a.indexOf("Chrome"))&&(h="Chrome",p=a.substring(i+7)):-1!==a.indexOf("Safari")?-1!==(i=a.indexOf("QQ"))?(h="qqbrowser",p=a.substring(i+10,i+16)):-1!==(i=a.indexOf("Safari"))&&(h="Safari",p=a.substring(i+7),-1!==(i=a.indexOf("Version"))&&(p=a.substring(i+8))):-1!==(i=a.indexOf("Firefox"))?(h="Firefox",p=a.substring(i+8)):-1!==(i=a.indexOf("MicroMessenger"))?(h="weixin",p=a.substring(i+15,i+20)):-1!==(i=a.indexOf("QQ"))&&(h="qqbrowser",p=a.substring(i+3,i+8)),-1!==(n=p.indexOf(";"))&&(p=p.substring(0,n)),-1!==(n=p.indexOf(" "))&&(p=p.substring(0,n)),-1!==(n=p.indexOf(")"))&&(p=p.substring(0,n));for(var _,l,g=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(s)?"wap":"web",m=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],v=0;v<m.length;v++){var z=m[v];if(z.r.test(a)){d=z.s;break}}function y(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""}switch(/Windows/.test(d)&&(f=y(/Windows (.*)/,d),d="windows"),d){case"Mac OS X":f=y(/Mac OS X (10[\.\_\d]+)/,a),d="mac";break;case"Android":(l=y(/Android ([\.\_\d]+)/,_=a))||(l=y(/Android\/([\.\_\d]+)/,_)),f=l,d="android";break;case"iOS":f=(f=/OS (\d+)_(\d+)_?(\d+)?/.exec(s))?f[1]+"."+f[2]+"."+(0|f[3]):"",d="ios"}var b=e?function(){var e=t?"_tea_utm_cache_"+t:"_tea_utm_cache",i={},n={utm_source:u.utm_source,utm_medium:u.utm_medium,utm_campaign:u.utm_campaign,utm_term:u.utm_term,utm_content:u.utm_content};try{var r=window.sessionStorage,o=!1;for(var s in n)n[s]&&(i[s]=n[s],o=!0);if(o)r.setItem(e,JSON.stringify(i));else{var a=r.getItem(e);a&&(i=JSON.parse(a))}}catch(e){return n}return i}():{};return{browser:h,browser_version:p,platform:g,os_name:d,os_version:f,userAgent:a,screen_width:r,screen_height:o,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e){var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){}return t.trim()}(d),language:c,referrer:"",referrer_host:"",utm_source:b.utm_source,utm_medium:b.utm_medium,utm_campaign:b.utm_campaign,utm_term:b.utm_term,utm_content:b.utm_content,isSupportBeacon:("ios"!==d||"safari"!==h)&&(!(!window.navigator||!window.navigator.sendBeacon)||void 0)}};var o,s=(function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function r(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(i);/^[\{\[]/.test(s)&&(i=s)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,!0!==o[c]&&(a+="="+o[c].split(";")[0]));return document.cookie=t+"="+i+a}}function s(e,i){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),c=a.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(n.read||n)(c,u)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(r[u]=c,e===u)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return s(e,!1)},r.getJSON=function(e){return s(e,!0)},r.remove=function(t,i){o(t,"",e(i,{expires:-1}))},r.defaults={},r.withConverter=i,r}(function(){})},e.exports=i()}(o={exports:{}},o.exports),o.exports),a=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}();var c={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e){try{var t=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]+)")),i=t?t[1]:"";return decodeURIComponent(i)}catch(e){return""}},setCookie:function(e,t,i){try{var n=+new Date+i;s.set(e,t,{expires:new Date(n),path:"/",domain:document.domain.split(".").slice(-2).join(".")})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},u=function(){function e(e){this._storage=!e&&c.isSupportLS?c:new a}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e){return this._storage.getCookie(e)},e.prototype.setCookie=function(e,t,i){this._storage.setCookie(e,t,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}();var d=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof t&&"number"==typeof i){var n,r=[];i=i<=25?i:i%25;var o=String.fromCharCode(i+97);n=e.split(o);for(var s=0;s<n.length;s++){var a=parseInt(n[s],i);a=1*a^t;var c=String.fromCharCode(a);r.push(c)}return r.join("")}}(e,64,25)},f={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},h="/v1/user/webid",p="/v1/list",_={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001},l=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e};["1fz22z22z1nz21z4mz4bz4bz1bz18z22z18z4az19z27z22z1cz1bz18z1lz1az1cz4az1az1mz1k","1fz22z22z1nz21z4mz4bz4bz25z25z25z4az19z27z22z1cz20z18z1lz1ez1cz20z21z4az1az1mz1k","1fz22z22z1nz21z4mz4bz4bz1bz18z22z18z20z18z1lz1ez1cz20z21z4az1az1mz1kz4az1az1l","1fz22z22z1nz21z4mz4bz4bz19z27z22z1cz20z18z1lz1ez1cz20z21z4az19z27z22z1cz1bz18z1lz1az1cz4az1az1mz1k"].map(function(e){return d(e)});var g=function(e,t,i,n){try{var r=e.match(/\/v\d\//),o="";o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var s=e.split(o)[0];if(!s)return void n(e,t,_.NO_URL);t.forEach(function(r){var o=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&(t+="&"+i+"="+encodeURIComponent(JSON.stringify(e[i])));return t="&"===t[0]?t.slice(1):t}(r),a=new Image(1,1);a.onload=function(){a=null,i&&i()},a.onerror=function(){a=null,n&&n(e,t,_.IMG_ON)},a.src=s+"/v1/gif?"+o})}catch(i){n&&n(e,t,_.IMG_CATCH,i.message)}},m=function(e,t,i,n,o,s,a,c){var u=window.navigator.userAgent,d=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==u.indexOf("MSIE 8.0")||-1!==u.indexOf("MSIE 9.0")),f=!!i;if(!f&&d)g(e,t,n,o);else if(!f&&a)return r(!1).isSupportBeacon?(c&&c(),void(window.navigator.sendBeacon(e,JSON.stringify(t))?n():o(e,t,_.BEACON_FALSE))):void g(e,t,n,o);s&&delete t.app_key,function(e,t,i,n,r,o,s){var a=new XMLHttpRequest;o&&(a.timeout=o);var c=s||"POST";a.open(c,""+e,!0),a.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&a.setRequestHeader("X-MCS-AppKey",""+r),a.onload=function(){if(i){var e=null;if(a.responseText){try{e=JSON.parse(a.responseText)}catch(t){e={}}i(e)}}},o&&(a.ontimeout=function(){n()}),a.onerror=function(){a.abort(),n&&n(t,_.XHR_ON)},a.send(JSON.stringify(t))}(e,t,n,o,i)};function v(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,v)}var z,y=function(){return v().replace(/-/g,"").slice(0,19)},b=function(){function e(e,t){this.browser=r(!0,e.app_id),this.config=e,this.cfg=t,this.storage=new u(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.isNoSsid=e.disable_webid||e.disable_ssid,this.domain=e.channel_domain||d(f[e.channel]),this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=this.enableCookie?94608e6:0,this.fetchUrl=""+this.domain+h}return e.prototype._getToken=function(){this.tokensKey=l(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;var e=this.storage.getItem(this.tokensKey);if(this.enableCookie){var t=this.storage.getCookie(this.cookieKey);if(t){t=decodeURIComponent(t);var i=(t=JSON.parse(t)).user_unique_id,n=t.web_id,r=t.timestamp,o=t.ssid;this._setToken(n,i,o,r)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime),this._checkLocal(e)}}else{if(!e)return void this._requestWebId();this._checkLocal(e)}},e.prototype._checkLocal=function(e){if(!e.web_id){var t=this.storage.getCookie("tt_webid"),i=this.storage.getCookie("__tea_sdk__ssid"),n=this.storage.getCookie("__tea_sdk__user_unique_id");if(t&&i&&n){var r={web_id:t,ssid:i,user_unique_id:n,timestamp:Date.now()};this.storage.setItem(this.tokensKey,r)}}var o=this.storage.getItem(this.tokensKey),s=(n=o.user_unique_id,t=o.web_id,o.timestamp);i=o.ssid;t&&n?this._setToken(t,n,i,s):this._requestWebId()},e.prototype._setToken=function(e,t,i,n){if(this.uuid=t,this.web_id=e,this.ssid=i,this.checkExp){var r=Date.now()-parseFloat(n);if(r>7344e6)return void this._requestWebId();if(r>432e7)return void this._updateWebId(e)}this._complete(e,t,i)},e.prototype._complete=function(e,t,i){this.cfg.envInfo.user.ssid=i,this.cfg.envInfo.user.web_id=e,this.cfg.envInfo.user.user_unique_id=t,this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setwebId({web_id:y(),ssid:""}):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+h+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var i=this;this.isGetWebId=!0,m(e,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:this.browser.userAgent,referer:this.browser.referrer,user_unique_id:""},this.config.app_key,function(e){if(e&&0===e.e)if(t){var n={web_id:i.web_id,ssid:i.ssid,user_unique_id:i.uuid,timestamp:Date.now()};i.enableCookie&&i.storage.setCookie(i.cookieKey,encodeURIComponent(JSON.stringify(n)),i.expiresTime),i.storage.setItem(i.tokensKey,n),i._complete(i.web_id,i.uuid,i.ssid),i.isGetSsid?i._requestSsId():i.callback&&i.callback()}else i.isGetWebId=!1,i._setwebId(e),i.isGetSsid?i._requestSsId():i.callback&&i.callback();else t?i._fetchWebId(i.fetchUrl,!1):i.isGetWebId=!1},function(){i.isGetWebId=!1},!0)},e.prototype._setwebId=function(e){var t=this.cfg.envInfo.user.web_id||e.web_id,i={web_id:t,ssid:e.ssid,user_unique_id:this._uuid?this._uuid:t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),this.expiresTime),this.storage.setItem(this.tokensKey,i),this.cfg.envInfo.user.ssid=e.ssid,this.cfg.envInfo.user.web_id=t,this.cfg.envInfo.user.user_unique_id=this._uuid?this._uuid:t,this.uuid=this._uuid?this._uuid:t,this.web_id=t,this.ssid=e.ssid,this.tokenReady=!0},e.prototype._getSsid=function(e){e&&-1===["0","Null","None","","undefined"].indexOf(e)&&(this.uuid===e&&this.web_id&&this.ssid?this.tokenReady=!0:(this._uuid=e,this.uuid=e,this.cfg.envInfo.user.user_unique_id=e,this.isGetSsid=!0,this.isNoSsid||this.isGetWebId?this.callback&&this.callback():(this.tokenReady=!1,this.isGetSsid=!1,this._requestSsId())))},e.prototype._requestSsId=function(){var e=this,t=this.domain+"/v1/user/ssid";m(t,{app_key:this.config.app_key,app_id:this.config.app_id,web_id:this.web_id,user_unique_id:this.uuid},this.config.app_key,function(t){if(t&&0===t.e){e.cfg.envInfo.user.ssid=t.ssid;var i={web_id:e.web_id,ssid:t.ssid,user_unique_id:e.uuid,timestamp:Date.now()};e.enableCookie&&e.storage.setCookie(e.cookieKey,encodeURIComponent(JSON.stringify(i)),e.expiresTime),e.storage.setItem(e.tokensKey,i),e.tokenReady=!0}else e.tokenReady=!0;e.callback&&e.callback()},function(){e.tokenReady=!0,e.callback&&e.callback()},!0)},e.prototype.isTokenReady=function(){return this.tokenReady},e}(),w=function(){function e(e,t,i,n,r){this.collect=e,this.cfg=i,this.config=t,this._token=n,this.appInfo=t.app_key||t.app_id,this.debugMode=!!t.log,this.evtDataKey=l(this.appInfo,!1);var o=t.channel_domain||d(f[t.channel]);this.reportUrl=t.report_url?t.report_url:""+o+p,this.storage=new u(!0),this.EventStorage=new u(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||20,this.closeStorage=!0,this.plugin=r,this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",function(){e.report(!0)},!1),function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}(this.report(!0)),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.report(!0)},!1)},e.prototype.setReady=function(){this.isReady=!0,this.report()},e.prototype.event=function(e,t){var i=this;void 0===e&&(e=[]),void 0===t&&(t=!1);var r=this.storage.getItem(this.evtDataKey)||[],o=t?n(e,r):n(r,e);this.storage.setItem(this.evtDataKey,o),this.reportTimer&&clearTimeout(this.reportTimer),o.length>=this.maxReport?this.report():this.reportTimer=setTimeout(function(){i.report(),i.reportTimer=null},30)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],i=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(i,e)}},e.prototype._mergeEvents=function(e){var i=this;if(!e.length)return e;var n=this.cfg.get();n.header.custom=JSON.stringify(n.header.custom);var r=[];return r.push(e),r.map(function(e){return{events:e.map(function(e){var n=t({},i.cfg.get("evtParams"),e.params);return delete n.__disable_storage__,t({},e,{params:JSON.stringify(n)})}),user:n.user,header:n.header,verbose:i.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3)}})},e.prototype._dealData=function(e,t){var i=this;if(!e.length)return e;e.map(function(e){var t=[];return t.push(e),t}).forEach(function(e){var n=y();i._send(n,e,t)})},e.prototype._send=function(e,t,i){var n=this;this.isSending=!0;var r=function(){n.isSending=!1};m(this.reportUrl,t,this.config.app_key,function(){r()},function(e,t){r(),n.cfg.get("reportErrorCallback")(e,t)},!1,i,r)},e.prototype.checkStorageEvent=function(){},e}(),k=void 0,I=(new Date).getTimezoneOffset(),S=parseInt(""+-I/60,10),O=60*I,x="4.1.24",C=function(){function e(e,t){var i=r(!0,e);this.initConfig=t,this.envInfo={user:{user_unique_id:k,user_type:k,user_id:k,user_is_auth:k,user_is_login:k,device_id:k,web_id:k,ip_addr_id:k,ssid:k},header:{app_id:k,app_name:k,app_install_id:k,install_id:k,app_package:k,app_channel:k,app_version:k,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:k,ab_version:k,ab_sdk_version:k,traffic_type:k,client_ip:k,device_brand:k,os_api:k,access:k,language:i.language,region:k,app_language:k,app_region:k,creative_id:k,ad_id:k,campaign_id:k,log_type:k,rnd:k,platform:i.platform,sdk_version:x,province:k,city:k,timezone:S,tz_offset:O,tz_name:k,sim_region:k,carrier:k,resolution:i.screen_width+"x"+i.screen_height,browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm_term,utm_content:i.utm_content,utm_source:i.utm_source,utm_medium:i.utm_medium,utm_campaign:i.utm_campaign,custom:{}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,i){var n=this;if("disable_auto_pv"!==e)if("evtParams"===e||"_staging_flag"===e){var r;r="evtParams"===e?i:{_staging_flag:Number(i)};var o=t({},r);Object.keys(o).forEach(function(e){n.evtParams[e]=o[e]})}else if("reportErrorCallback"===e&&"function"==typeof i)this.reportErrorCallback=i;else{var s="";if(e.indexOf(".")>-1){var a=e.split(".");s=a[0],e=a[1]}if("user_unique_id"===e){if(!i)return;if(-1!==["0","Null","None","","undefined"].indexOf(i))return}if("os_version"===e&&(e=""+i),"web_id"===e){if(!i)return;(!this.envInfo.user.user_unique_id||this.envInfo.user.user_unique_id&&this.envInfo.user.user_unique_id===this.envInfo.user.web_id)&&(this.envInfo.user.user_unique_id=i)}s?"user"===s||"header"===s?this.envInfo[s][e]=i:this.envInfo.header.custom[e]=i:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=Number(i):["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=String(i):["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=Boolean(i):"device_id"===e&&(this.initConfig&&this.initConfig.channel&&"cn"===this.initConfig.channel?this.envInfo.user[e]=i:this.envInfo.user[e]=Number(i)):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=i:this.envInfo.header.custom[e]=i}},e.prototype.get=function(e){return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this.reportErrorCallback:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))},e}(),E=function(){function e(e,t){this.isLog=t,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}(),N=n(["init","config","send","start","predefinePageView","resetStayDuration","autoInitializationRangers"],["setProfile","setOnceProfile","getVar","openOverlayer","closeOverlayer","getAllVars","getToken","destroy"]),q=(z=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return z+=1}),R=function(){function e(e){var i=this;this.predefinePageView=function(e){void 0===e&&(e={});var n=t({title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer},i._event.closeStorage?{}:{__disable_storage__:1}),r=t({},n,e);i.event("predefine_pageview",r,!0)},this.getToken=function(e){},this.name=e,this._isSend=!1,this.autoPV=!0}return e.prototype.autoInitializationRangers=function(e){e&&e.app_id&&(this.autoBase=!0,function(e){var t=e.app_id,i=e.channel,n=e.onTokenReady,r=""+d(f[i])+h,o=new u(!1),s=l(t,!0),a=o.getItem(s);a&&a.web_id?n(a.web_id):m(r,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},"",function(e){if(e&&0===e.e){n(e.web_id);var t={web_id:e.web_id,ssid:e.ssid,user_unique_id:e.web_id,timestamp:Date.now()};o.setItem(s,t)}else n("")},function(){n("")},!0)}(e))},e.prototype.init=function(e){var t=this;if(!this.autoBase&&!this._inited){if(this._inited=!0,!e||"object"!=typeof e)throw new Error("init params is error,please check");var i=e.app_id,n=e.app_key,r=e.log;this._config=new C(i,e),this.logger=new E(this.name,r),n||i||this.logger.throw("no app_key or app_id please check !!!"),i&&"number"!=typeof i&&this.logger.throw("app_id param is error,must be number,please check !!!"),n&&"string"!=typeof n&&this.logger.warn("app_key is empty"),e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)||this.logger.throw("channel must be `cn`, `sg`,`va` !!!"),this._config.set("app_id",i),e.channel=e.channel?e.channel:"cn",this._initConfig=e,this._token=new b(e,this._config),this._token.callback=function(){t.callbackSend?t.start():t._event&&t._event.report()},this._event=new w(this,e,this._config,this._token,this.plugin),this._token._getToken()}},e.prototype.config=function(e){if(!this.autoBase)if(this._inited)if(e&&"object"==typeof e){if(e.user_unique_id){"string"!=typeof e.user_unique_id&&this.logger.warn("user_unique_id must be string!!! please check");try{var t=String(e.user_unique_id);this._token._getSsid(t)}catch(e){}}for(var i in e.disable_auto_pv&&(this.autoPV=!1),e)this._config.set(i,e[i])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.send=function(){this.start()},e.prototype.start=function(){if(!this.autoBase)if(this._token.isTokenReady()){if(this._isSend)return;this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready, you can report now !!!"),this._event.setReady(),this.autoPV&&this.predefinePageView()}else this.callbackSend=!0},e.prototype.event=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="boolean"==typeof e[e.length-1]&&e[e.length-1],r="boolean"==typeof e[e.length-1]?e.slice(0,e.length-1):e,o=i(r,1)[0],s=[];"Array"!==Object.prototype.toString.call(o).slice(8,-1)?s[0]=r:s=r;s=s.map(function(e){return function(e,t,i){(void 0===i?{}:i).isBav;var n=e;/^event\./.test(e)&&(n=e.slice(6));var r=t;return"object"!=typeof r&&(r={}),r.event_index=q(),{event:n,params:r,local_time_ms:r.local_ms||+new Date,is_bav:0}}(e[0],e[1],{isBav:!1})}),this._event.event(s,n)},e.prototype.resetStayDuration=function(e,t,i){},e.prototype.setProfile=function(e){},e.prototype.setOnceProfile=function(e){},e.prototype.getVar=function(e,t,i){},e.prototype.openOverlayer=function(){},e.prototype.closeOverlayer=function(){},e.prototype.getAllVars=function(e){},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0)},e}();function P(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var T=function(e){var t=this;return P(this,"_exportCollect",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._isProcess?t._executeCmd.apply(t,i):(t.cmdQueue.push(i),t._processCmd())}),P(this,"_processCmd",function(){if(0!==t.cmdQueue.length){var e,i=function(e,t,i){var n=-1;return e.forEach(function(e,r){(void 0!==i?e[i]:e)===t&&(n=r)}),n};-1===(e=i(t.cmdQueue,"autoInitializationRangers","0"))&&(e=i(t.cmdQueue,"init","0")),-1!==e&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach(function(i,n){n!==e&&t._executeCmd.apply(t,i)}),t.cmdQueue=[])}}),P(this,"_executeCmd",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var r,o,s=i[0];N.indexOf(s)>-1?(r=t.colloctor)[s].apply(r,i.slice(1)):(o=t.colloctor).event.apply(o,i)}),this.cmdQueue=[],this.name=e,this.colloctor=new R(e),this._isProcess=!1,this._alias={},this._processCmd(),N.forEach(function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)}),this._exportCollect},M={},W={},A=function(e){return W[e]||(W[e]=[]),W[e]},D=function(e){try{var t=i(e),r=t[0],o=t.slice(1);if(!r)return void console.error("the eventName is: "+r+", error, stop report, please check");var s=r.split(".");if(1===s.length)A("default").push(n([r],o));else if(2===s.length)"event"===s[0]?A("default").push(n([r],o)):A(s[0]).push(n([s[1]],o));else{var a=s[0],c=[s[1],s[2]].join(".");A(a).push(n([c],o))}}catch(e){console.log(e)}},J=function(){U.q.forEach(function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach(function(e){D(e)}):D(t)}),Object.keys(W).forEach(function(e){W[e].forEach(function(t){(function(e){return M[e]||(M[e]=new T(e)),M[e]})(e).apply(void 0,n(t))}),W[e]=[]}),U.q=[]},U=function e(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.q.push(t),J()};U.q=[],U.l=Date.now(),U._instanceMap=M,U._instanceCmdMap=W,N.forEach(function(e){U[e]=U.bind(null,e)}),function(e){if("undefined"!=typeof window){var t=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject}();if(t&&window[t]){var i=window[t];i.init||(e.q=i.q||[],e.l=i.l||Date.now(),window[t]=e)}}}(U),J();var L=T;return e.Collector=L,e.default=U,e}({});
